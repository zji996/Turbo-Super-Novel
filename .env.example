# Turbo-Super-Novel (.env) - local dev defaults
#
# Usage:
#   cp .env.example .env
#   docker compose -f infra/docker-compose.dev.yml up -d
#   bash scripts/tsn_up.sh
#
# Notes:
# - Leave MODELS_DIR/DATA_DIR/LOG_DIR empty to use <repo_root>/{models,data,logs} automatically.
# - Core model path (local hosting): models/turbodiffusion/TurboWan2.2-I2V-A14B-720P

# -----------------------------------------------------------------------------
# Local runtime dirs (optional)
# -----------------------------------------------------------------------------
MODELS_DIR=
DATA_DIR=
LOG_DIR=
# PID file directory used by scripts/tsn_manage.sh (optional; default: <DATA_DIR>/tsn_runtime/pids)
PID_DIR=

# -----------------------------------------------------------------------------
# API process (optional; used by scripts/tsn_manage.sh)
# -----------------------------------------------------------------------------
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=1

# -----------------------------------------------------------------------------
# Celery (API + Worker)
# -----------------------------------------------------------------------------
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# Worker tuning (optional; used by scripts/tsn_manage.sh)
CELERY_LOG_LEVEL=info
CELERY_CONCURRENCY=5
CELERY_PREFETCH_MULTIPLIER=1

# -----------------------------------------------------------------------------
# S3 / MinIO (required for inputs/outputs)
# -----------------------------------------------------------------------------
S3_ENDPOINT=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET_NAME=turbo-super-novel
S3_REGION=us-east-1

# -----------------------------------------------------------------------------
# Postgres (optional; enables job status persistence)
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql+psycopg://postgres:postgres@localhost:5432/tsn

# These are only used by infra/docker-compose.dev.yml (optional).
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=tsn

# -----------------------------------------------------------------------------
# TurboDiffusion runtime knobs (optional)
# -----------------------------------------------------------------------------
# umT5 text encoder device. Default is `cuda` in code; set to `cpu` if VRAM is tight.
TD_UMT5_DEVICE=cuda

# PyTorch/HF QoL toggles.
PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True
TOKENIZERS_PARALLELISM=false

# Leave HF_HOME unset to let the code default to <DATA_DIR>/hf.
# HF_HOME=/absolute/path/to/hf_cache

# -----------------------------------------------------------------------------
# CUDA toolchain (optional; only needed when building `turbo_diffusion_ops`)
# -----------------------------------------------------------------------------
# If your system `nvcc` major version doesn't match PyTorch (e.g. torch +cu128),
# follow docs/turbodiffusion_i2v_runbook.md and point CUDA_HOME to a CUDA 12.8 toolkit.
# CUDA_HOME=$HOME/.local/cuda-12.8
# CUDACXX=$CUDA_HOME/bin/nvcc
# MAX_JOBS=5
# USE_NINJA=1
